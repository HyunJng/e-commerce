# k6 부하 테스트 결과 보고서

## 목적 및 시나리오 선정 배경

* **대상 선정**

    * **주문 생성(Order)**: 이커머스 도메인에서 가장 중요한 핵심 시나리오로, **재고 차감·쿠폰 사용·포인트 차감** 등 다수의 리소스가 동시에 관여한다. 높은 원자성이 요구되는 경로이므로 성능 병목이 발생할 가능성이 높다.

* **시나리오 설계 목적**

    * 실제 사용자 행동을 반영한 **엔드투엔드 흐름**을 재현:

        1. 인기상품 조회 → 2) 상품 상세 조회 → 3) 주문 생성
    * 주문 생성 시 쿠폰 사용을 랜덤하게 섞어, 다양한 케이스를 시뮬레이션.
    * 단순 API 단위 성능이 아니라 **연속적인 비즈니스 트랜잭션**의 병목을 파악하기 위함.

---

## 주문결제 테스트 

### 1) 환경 및 시나리오

#### 실행 옵션

* 테스트 도구: K6
* 테스트 대상: 주문 시나리오 API 서버
* 가상 사용자 수(VU): preAllocatedVUs=300, maxVUs=1200
* 테스트 실행 시간: 약 3분 45초 (Ramp-up → 유지 → Cool-down 포함)
* 총 요청 수: 42,583건
* 총 Iteration 수: 19,768회
* 드롭된 Iteration 수: 27,106회
* SLA:

    * 전역: p95 < 500ms
    * 엔드포인트별: Best < 400ms, Item < 400ms, Order < 800ms

#### 트래픽 플로우

1. 인기상품 조회 `/api/v1/products/best`
2. 상품 상세 조회 `/api/v1/products/{id}`
3. 주문 생성 `/api/v1/orders`

---

### 2) 주요 지표(실측)

* **평균 RPS**: 181.85 (목표 300 미달)
* **응답시간**: avg 4.3s, p95 9.11s (SLA 초과)
* **실패율**: 0.02% (안정적)
* **드롭된 요청**: 27,106 (목표 RPS 유지 불가)

---

### 3) 해석

* SLA(p95 < 500ms) 미달, 실제 처리량은 180 RPS 수준.
* Order API가 병목 지점으로 보이며, DB 락·트랜잭션 경합 가능성 높음.
* 실패율은 낮아 정합성은 양호하나, 대기 시간이 길어 **실사용 불가 수준**.

---

### 4) 시나리오 목적과 의의

* **핵심 경로 검증**: 주문 시나리오는 서비스 성능 병목이 가장 잘 드러나는 구간이다. 부하 테스트를 통해 실제 운영 시 대규모 트래픽이 몰렸을 때 어떤 한계에 부딪히는지 확인할 수 있다.
* **장애 시뮬레이션**: 이번 결과에서 드롭 발생과 SLA 위반을 통해, 서비스가 고부하 상황에서 어떻게 응답하는지(대기 지연·드롭) 확인하였다.
* **개선 방향 도출**: DB 쿼리 최적화, 트랜잭션 범위 축소, 캐시·비동기 처리 도입 등 구체적인 개선 과제를 확인할 수 있었다.
